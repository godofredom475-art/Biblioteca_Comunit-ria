<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Biblioteca Comunitária - Feedback de Livros</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #8B5E3C;
            --secondary: #D4A574;
            --accent: #E8D5C4;
            --dark: #2C1810;
            --paper: #FDF8F3;
        }
        
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--paper);
            color: var(--dark);
            overflow-x: hidden;
        }
        
        h1, h2, h3, .serif {
            font-family: 'Playfair Display', serif;
        }
        
        .book-shadow {
            box-shadow: 
                -2px 0 5px rgba(0,0,0,0.1),
                2px 2px 10px rgba(0,0,0,0.15),
                0 0 0 1px rgba(0,0,0,0.05);
        }
        
        .paper-texture {
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 31px, rgba(0,0,0,0.03) 31px, rgba(0,0,0,0.03) 32px),
                repeating-linear-gradient(90deg, transparent, transparent 31px, rgba(0,0,0,0.03) 31px, rgba(0,0,0,0.03) 32px);
        }
        
        .feedback-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .feedback-card:active {
            transform: scale(0.98);
        }
        
        .modal-enter {
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(100%);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .float-label {
            transition: all 0.2s ease;
        }
        
        .float-label.active {
            transform: translateY(-24px) scale(0.85);
            color: var(--primary);
        }
        
        .genre-tag {
            background: linear-gradient(135deg, var(--accent) 0%, #fff 100%);
            border: 1px solid rgba(139, 94, 60, 0.2);
        }
        
        .rating-stars {
            display: inline-flex;
            gap: 4px;
        }
        
        .rating-stars i {
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.5rem;
            padding: 0.25rem;
        }
        
        .toast {
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        /* Mobile-specific improvements */
        @media (max-width: 640px) {
            .hero-title {
                font-size: 2.25rem !important;
                line-height: 1.2 !important;
            }
            
            .genre-scroll {
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }
            
            .genre-scroll::-webkit-scrollbar {
                display: none;
            }
            
            .modal-content {
                max-height: 90vh;
                overflow-y: auto;
            }
            
            .touch-target {
                min-height: 44px;
                min-width: 44px;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }
        
        /* Prevent zoom on input focus for iOS */
        @media screen and (max-width: 768px) {
            input, textarea, select {
                font-size: 16px;
            }
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .like-btn:active {
            transform: scale(0.9);
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="min-h-screen paper-texture">

    <!-- Navigation -->
    <nav class="sticky top-0 z-40 bg-white/95 backdrop-blur-md border-b border-amber-200/50 safe-top">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-14 sm:h-16">
                <div class="flex items-center gap-2 sm:gap-3">
                    <div class="w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-amber-700 to-amber-900 rounded-lg flex items-center justify-center text-white">
                        <i class="fas fa-book-open text-sm sm:text-lg"></i>
                    </div>
                    <span class="text-lg sm:text-2xl font-bold serif text-amber-900 truncate">
                        Biblioteca<span class="text-amber-600">Comunitária</span>
                    </span>
                </div>
                <button onclick="openModal()" class="bg-amber-800 hover:bg-amber-900 text-white px-3 sm:px-6 py-2 rounded-full text-sm font-medium transition-all hover:shadow-lg active:scale-95 flex items-center gap-1 sm:gap-2 touch-target">
                    <i class="fas fa-plus"></i>
                    <span class="hidden sm:inline">Novo Feedback</span>
                    <span class="sm:hidden">Novo</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative overflow-hidden bg-gradient-to-b from-amber-50 to-white py-8 sm:py-16">
        <div class="absolute inset-0 opacity-10 pointer-events-none">
            <div class="absolute top-4 left-4 sm:top-10 sm:left-10 text-6xl sm:text-9xl text-amber-900 serif">"</div>
            <div class="absolute bottom-4 right-4 sm:bottom-10 sm:right-10 text-6xl sm:text-9xl text-amber-900 serif rotate-180">"</div>
        </div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center max-w-3xl mx-auto">
                <h1 class="text-3xl sm:text-5xl md:text-6xl font-bold text-amber-900 mb-4 sm:mb-6 leading-tight hero-title">
                    Compartilhe suas <span class="text-amber-600 italic">leituras</span>
                </h1>
                <p class="text-base sm:text-xl text-amber-800/70 mb-6 sm:mb-8 leading-relaxed px-2">
                    Descubra novos mundos através dos olhos de outros leitores. 
                    Compartilhe suas experiências e encontre sua próxima aventura literária.
                </p>
                <div class="flex justify-center gap-3 sm:gap-4 text-xs sm:text-sm text-amber-700/60 flex-wrap">
                    <span class="flex items-center gap-1 sm:gap-2 bg-white/50 px-3 py-1 rounded-full">
                        <i class="fas fa-users"></i> 
                        <span id="totalReviews">0</span> avaliações
                    </span>
                    <span class="flex items-center gap-1 sm:gap-2 bg-white/50 px-3 py-1 rounded-full">
                        <i class="fas fa-book"></i> 
                        <span id="totalBooks">0</span> livros
                    </span>
                    <span class="flex items-center gap-1 sm:gap-2 bg-white/50 px-3 py-1 rounded-full">
                        <i class="fas fa-star"></i> 
                        Média <span id="avgRating">0.0</span>
                    </span>
                </div>
            </div>
        </div>
    </header>

    <!-- Filters Section -->
    <section class="sticky top-14 sm:top-16 z-30 bg-white/90 backdrop-blur-md border-b border-amber-100 py-3 sm:py-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 items-start sm:items-center justify-between">
                <div class="flex gap-2 overflow-x-auto w-full sm:w-auto pb-1 sm:pb-0 genre-scroll" id="genreFilters">
                    <button onclick="filterByGenre('all')" class="genre-btn active px-4 py-2 rounded-full text-sm font-medium transition-all bg-amber-800 text-white whitespace-nowrap touch-target" data-genre="all">
                        Todos
                    </button>
                    <button onclick="filterByGenre('ficcao')" class="genre-btn px-4 py-2 rounded-full text-sm font-medium transition-all genre-tag text-amber-900 hover:bg-amber-100 whitespace-nowrap touch-target" data-genre="ficcao">
                        Ficção
                    </button>
                    <button onclick="filterByGenre('romance')" class="genre-btn px-4 py-2 rounded-full text-sm font-medium transition-all genre-tag text-amber-900 hover:bg-amber-100 whitespace-nowrap touch-target" data-genre="romance">
                        Romance
                    </button>
                    <button onclick="filterByGenre('tecnologia')" class="genre-btn px-4 py-2 rounded-full text-sm font-medium transition-all genre-tag text-amber-900 hover:bg-amber-100 whitespace-nowrap touch-target" data-genre="tecnologia">
                        Tecnologia
                    </button>
                    <button onclick="filterByGenre('biografia')" class="genre-btn px-4 py-2 rounded-full text-sm font-medium transition-all genre-tag text-amber-900 hover:bg-amber-100 whitespace-nowrap touch-target" data-genre="biografia">
                        Biografia
                    </button>
                    <button onclick="filterByGenre('fantasia')" class="genre-btn px-4 py-2 rounded-full text-sm font-medium transition-all genre-tag text-amber-900 hover:bg-amber-100 whitespace-nowrap touch-target" data-genre="fantasia">
                        Fantasia
                    </button>
                </div>
                <div class="w-full sm:w-auto">
                    <select id="sortSelect" onchange="sortFeedbacks()" class="w-full sm:w-auto px-4 py-2 rounded-lg border border-amber-200 bg-white text-amber-900 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500 touch-target">
                        <option value="newest">Mais recentes</option>
                        <option value="rating">Maior avaliação</option>
                        <option value="title">Ordem alfabética</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-12">
        <div id="feedbacksContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-8 card-grid">
            <!-- Feedbacks will be inserted here -->
        </div>
        
        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-12 sm:py-20">
            <div class="w-16 h-16 sm:w-24 sm:h-24 mx-auto mb-4 sm:mb-6 text-amber-200">
                <i class="fas fa-book-open text-4xl sm:text-6xl"></i>
            </div>
            <h3 class="text-xl sm:text-2xl font-bold text-amber-900 mb-2 serif">Nenhum feedback ainda</h3>
            <p class="text-amber-700/60 text-sm sm:text-base">Seja o primeiro a compartilhar sua opinião sobre um livro!</p>
        </div>
    </main>

    <!-- Modal -->
    <div id="feedbackModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="relative min-h-screen sm:min-h-0 sm:flex sm:items-center sm:justify-center sm:p-4">
            <div class="bg-white sm:rounded-2xl shadow-2xl w-full sm:w-full sm:max-w-lg modal-enter modal-content sm:max-h-[90vh] sm:overflow-y-auto absolute bottom-0 sm:relative sm:bottom-auto rounded-t-2xl sm:rounded-t-2xl">
                <div class="bg-gradient-to-r from-amber-800 to-amber-900 px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center sticky top-0 z-10">
                    <h2 class="text-lg sm:text-xl font-bold text-white serif">Novo Feedback</h2>
                    <button onclick="closeModal()" class="text-white/80 hover:text-white transition-colors p-2 touch-target">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <form id="feedbackForm" class="p-4 sm:p-6 space-y-4 sm:space-y-6">
                    <!-- Book Cover Preview -->
                    <div class="flex justify-center mb-4">
                        <div id="coverPreview" class="w-24 h-36 sm:w-32 sm:h-48 bg-gradient-to-br from-amber-100 to-amber-200 rounded-lg book-shadow flex items-center justify-center text-amber-400">
                            <i class="fas fa-book text-3xl sm:text-4xl"></i>
                        </div>
                    </div>
                    
                    <!-- Book Title -->
                    <div class="relative">
                        <input type="text" id="bookTitle" required 
                            class="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent peer text-base"
                            placeholder=" ">
                        <label class="float-label absolute left-4 top-3 text-amber-600/60 pointer-events-none bg-white px-1 text-sm sm:text-base">
                            Título do Livro
                        </label>
                    </div>
                    
                    <!-- Author -->
                    <div class="relative">
                        <input type="text" id="bookAuthor" required 
                            class="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent peer text-base"
                            placeholder=" ">
                        <label class="float-label absolute left-4 top-3 text-amber-600/60 pointer-events-none bg-white px-1 text-sm sm:text-base">
                            Autor
                        </label>
                    </div>
                    
                    <!-- Genre -->
                    <div>
                        <label class="block text-sm font-medium text-amber-900 mb-2">Gênero</label>
                        <select id="bookGenre" class="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-white text-base touch-target">
                            <option value="ficcao">Ficção</option>
                            <option value="romance">Romance</option>
                            <option value="tecnologia">Tecnologia</option>
                            <option value="biografia">Biografia</option>
                            <option value="fantasia">Fantasia</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>
                    
                    <!-- Rating -->
                    <div>
                        <label class="block text-sm font-medium text-amber-900 mb-2">Sua Avaliação</label>
                        <div class="rating-stars text-2xl" id="starRating">
                            <i class="fas fa-star text-gray-300 touch-target" data-rating="1"></i>
                            <i class="fas fa-star text-gray-300 touch-target" data-rating="2"></i>
                            <i class="fas fa-star text-gray-300 touch-target" data-rating="3"></i>
                            <i class="fas fa-star text-gray-300 touch-target" data-rating="4"></i>
                            <i class="fas fa-star text-gray-300 touch-target" data-rating="5"></i>
                        </div>
                        <input type="hidden" id="ratingValue" value="0" required>
                    </div>
                    
                    <!-- Review -->
                    <div class="relative">
                        <textarea id="bookReview" rows="3" required 
                            class="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent resize-none text-base"
                            placeholder=" "></textarea>
                        <label class="float-label absolute left-4 top-3 text-amber-600/60 pointer-events-none bg-white px-1 text-sm sm:text-base">
                            Sua opinião sobre o livro...
                        </label>
                    </div>
                    
                    <!-- User Name -->
                    <div class="relative">
                        <input type="text" id="userName" required 
                            class="w-full px-4 py-3 border border-amber-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent peer text-base"
                            placeholder=" ">
                        <label class="float-label absolute left-4 top-3 text-amber-600/60 pointer-events-none bg-white px-1 text-sm sm:text-base">
                            Seu Nome
                        </label>
                    </div>
                    
                    <button type="submit" 
                        class="w-full bg-amber-800 hover:bg-amber-900 text-white font-bold py-3 rounded-lg transition-all hover:shadow-lg active:scale-95 touch-target text-base">
                        Publicar Feedback
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="fixed bottom-4 right-4 left-4 sm:left-auto z-50 space-y-2 pointer-events-none"></div>

    <script>
        // Data Management
        let feedbacks = [
            {
                id: 1,
                title: "O Pequeno Príncipe",
                author: "Antoine de Saint-Exupéry",
                genre: "ficcao",
                rating: 5,
                review: "Uma obra atemporal que nos faz refletir sobre o que realmente importa na vida. A simplicidade da narrativa esconde profundas lições sobre amor, amizade e responsabilidade.",
                userName: "Maria Silva",
                date: new Date('2024-02-15'),
                likes: 12
            },
            {
                id: 2,
                title: "Clean Code",
                author: "Robert C. Martin",
                genre: "tecnologia",
                rating: 4,
                review: "Essencial para qualquer desenvolvedor que quer escrever código de qualidade. Algumas partes são densas, mas o conhecimento adquirido compensa.",
                userName: "João Pedro",
                date: new Date('2024-02-10'),
                likes: 8
            },
            {
                id: 3,
                title: "1984",
                author: "George Orwell",
                genre: "ficcao",
                rating: 5,
                review: "Distópico e assustadoramente atual. Orwell criou um mundo que serve como aviso permanente sobre os perigos do totalitarismo.",
                userName: "Ana Costa",
                date: new Date('2024-02-05'),
                likes: 15
            }
        ];
        
        let currentFilter = 'all';
        let currentSort = 'newest';

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderFeedbacks();
            updateStats();
            setupStarRating();
            setupFloatingLabels();
        });

        // Render Feedbacks
        function renderFeedbacks() {
            const container = document.getElementById('feedbacksContainer');
            const emptyState = document.getElementById('emptyState');
            
            let filtered = feedbacks;
            if (currentFilter !== 'all') {
                filtered = feedbacks.filter(f => f.genre === currentFilter);
            }
            
            // Sort
            filtered = sortFeedbacksData(filtered);
            
            if (filtered.length === 0) {
                container.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            container.innerHTML = filtered.map(feedback => createFeedbackCard(feedback)).join('');
        }

        function createFeedbackCard(feedback) {
            const genreLabels = {
                ficcao: 'Ficção',
                romance: 'Romance',
                tecnologia: 'Tecnologia',
                biografia: 'Biografia',
                fantasia: 'Fantasia',
                outro: 'Outro'
            };
            
            const genreColors = {
                ficcao: 'bg-blue-100 text-blue-800',
                romance: 'bg-pink-100 text-pink-800',
                tecnologia: 'bg-green-100 text-green-800',
                biografia: 'bg-amber-100 text-amber-800',
                fantasia: 'bg-purple-100 text-purple-800',
                outro: 'bg-gray-100 text-gray-800'
            };
            
            const stars = Array(5).fill(0).map((_, i) => 
                `<i class="fas fa-star ${i < feedback.rating ? 'text-amber-400' : 'text-gray-300'} text-xs sm:text-sm"></i>`
            ).join('');
            
            const dateStr = feedback.date.toLocaleDateString('pt-BR', { 
                day: 'numeric', 
                month: 'short', 
                year: 'numeric' 
            });
            
            return `
                <article class="feedback-card bg-white rounded-xl book-shadow overflow-hidden" data-id="${feedback.id}">
                    <div class="p-4 sm:p-6">
                        <div class="flex justify-between items-start mb-3 sm:mb-4">
                            <span class="px-2 sm:px-3 py-1 rounded-full text-xs font-semibold ${genreColors[feedback.genre]}">
                                ${genreLabels[feedback.genre]}
                            </span>
                            <div class="flex gap-0.5 sm:gap-1">
                                ${stars}
                            </div>
                        </div>
                        
                        <h3 class="text-lg sm:text-xl font-bold text-amber-900 mb-1 serif leading-tight">${feedback.title}</h3>
                        <p class="text-xs sm:text-sm text-amber-600/80 mb-3 sm:mb-4 italic">por ${feedback.author}</p>
                        
                        <div class="relative mb-3 sm:mb-4">
                            <i class="fas fa-quote-left text-amber-200 text-lg sm:text-2xl absolute -top-1 -left-1 sm:-top-2 sm:-left-2"></i>
                            <p class="text-amber-800/80 text-sm leading-relaxed pl-4 sm:pl-6 line-clamp-3">
                                ${feedback.review}
                            </p>
                        </div>
                        
                        <div class="flex items-center justify-between pt-3 sm:pt-4 border-t border-amber-100">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center text-white text-xs font-bold">
                                    ${feedback.userName.charAt(0).toUpperCase()}
                                </div>
                                <div class="text-xs">
                                    <p class="font-semibold text-amber-900 truncate max-w-[100px] sm:max-w-[150px]">${feedback.userName}</p>
                                    <p class="text-amber-600/60">${dateStr}</p>
                                </div>
                            </div>
                            <button onclick="likeFeedback(${feedback.id})" class="like-btn flex items-center gap-1 text-amber-600 hover:text-amber-800 transition-colors p-2 touch-target">
                                <i class="fas fa-heart ${feedback.liked ? 'text-red-500' : ''} text-sm sm:text-base"></i>
                                <span class="text-xs font-medium">${feedback.likes}</span>
                            </button>
                        </div>
                    </div>
                    <div class="h-1.5 sm:h-2 bg-gradient-to-r from-amber-200 via-amber-400 to-amber-200"></div>
                </article>
            `;
        }

        // Filter Functions
        function filterByGenre(genre) {
            currentFilter = genre;
            
            // Update buttons
            document.querySelectorAll('.genre-btn').forEach(btn => {
                if (btn.dataset.genre === genre) {
                    btn.classList.remove('genre-tag', 'text-amber-900');
                    btn.classList.add('bg-amber-800', 'text-white');
                } else {
                    btn.classList.add('genre-tag', 'text-amber-900');
                    btn.classList.remove('bg-amber-800', 'text-white');
                }
            });
            
            renderFeedbacks();
        }

        function sortFeedbacks() {
            currentSort = document.getElementById('sortSelect').value;
            renderFeedbacks();
        }

        function sortFeedbacksData(data) {
            const sorted = [...data];
            switch(currentSort) {
                case 'newest':
                    return sorted.sort((a, b) => b.date - a.date);
                case 'rating':
                    return sorted.sort((a, b) => b.rating - a.rating);
                case 'title':
                    return sorted.sort((a, b) => a.title.localeCompare(b.title));
                default:
                    return sorted;
            }
        }

        // Modal Functions
        function openModal() {
            document.getElementById('feedbackModal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            // Prevent background scrolling on mobile
            document.body.style.position = 'fixed';
            document.body.style.width = '100%';
        }

        function closeModal() {
            document.getElementById('feedbackModal').classList.add('hidden');
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
            document.getElementById('feedbackForm').reset();
            resetStarRating();
        }

        // Star Rating
        function setupStarRating() {
            const stars = document.querySelectorAll('#starRating i');
            const ratingInput = document.getElementById('ratingValue');
            
            stars.forEach(star => {
                star.addEventListener('click', () => {
                    const rating = parseInt(star.dataset.rating);
                    ratingInput.value = rating;
                    updateStars(rating);
                });
            });
        }

        function updateStars(rating) {
            const stars = document.querySelectorAll('#starRating i');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('text-gray-300');
                    star.classList.add('text-amber-400');
                } else {
                    star.classList.remove('text-amber-400');
                    star.classList.add('text-gray-300');
                }
            });
        }

        function resetStarRating() {
            document.getElementById('ratingValue').value = '0';
            updateStars(0);
        }

        // Floating Labels
        function setupFloatingLabels() {
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('focus', () => {
                    input.nextElementSibling?.classList.add('active');
                });
                input.addEventListener('blur', () => {
                    if (!input.value) {
                        input.nextElementSibling?.classList.remove('active');
                    }
                });
                // Check initial value
                if (input.value) {
                    input.nextElementSibling?.classList.add('active');
                }
            });
        }

        // Form Submission
        document.getElementById('feedbackForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const newFeedback = {
                id: Date.now(),
                title: document.getElementById('bookTitle').value,
                author: document.getElementById('bookAuthor').value,
                genre: document.getElementById('bookGenre').value,
                rating: parseInt(document.getElementById('ratingValue').value),
                review: document.getElementById('bookReview').value,
                userName: document.getElementById('userName').value,
                date: new Date(),
                likes: 0
            };
            
            if (newFeedback.rating === 0) {
                showToast('Por favor, selecione uma avaliação!', 'error');
                return;
            }
            
            feedbacks.unshift(newFeedback);
            renderFeedbacks();
            updateStats();
            closeModal();
            showToast('Feedback publicado com sucesso!', 'success');
        });

        // Like Function
        function likeFeedback(id) {
            const feedback = feedbacks.find(f => f.id === id);
            if (feedback) {
                if (!feedback.liked) {
                    feedback.likes++;
                    feedback.liked = true;
                    showToast('Você curtiu esta avaliação!', 'success');
                } else {
                    feedback.likes--;
                    feedback.liked = false;
                }
                renderFeedbacks();
            }
        }

        // Stats
        function updateStats() {
            document.getElementById('totalReviews').textContent = feedbacks.length;
            document.getElementById('totalBooks').textContent = new Set(feedbacks.map(f => f.title)).size;
            
            const avg = feedbacks.reduce((acc, f) => acc + f.rating, 0) / feedbacks.length || 0;
            document.getElementById('avgRating').textContent = avg.toFixed(1);
        }

        // Toast Notifications
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            
            const colors = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            const icon = type === 'success' ? 'check-circle' : 'exclamation-circle';
            
            toast.className = `toast ${colors} text-white px-4 sm:px-6 py-3 rounded-lg shadow-lg flex items-center gap-2 pointer-events-auto mx-auto sm:mx-0 sm:min-w-[300px]`;
            toast.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span class="font-medium text-sm sm:text-base">${message}</span>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });
        
        // Handle window resize
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                renderFeedbacks();
            }, 250);
        });
    </script>
</body>
</html>